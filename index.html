<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Be My Valentine? ðŸ’—</title>
    <link rel="stylesheet" href="style.css" />
  </head>

  <body>
    <!-- floating hearts/roses layer -->
    <div class="bg-sparkles" aria-hidden="true"></div>

    <main class="wrap">
      <section class="card" id="card">

        <h1 class="question" id="question">
          Will you be my Valentine?
        </h1>

        <p class="sub" id="subtitle">
          Choose wisely.
        </p>

        <div class="photo" id="photo">
          <img id="mainImg" src="assets/images/monkeys.jpg" alt="Cute photo" />
        </div>

        <!-- hidden audio (no player UI) -->
        <audio id="song" preload="auto">
          <source src="assets/music/careless-whisper.mp3" type="audio/mpeg" />
        </audio>

        <div class="buttons">
          <button id="yes" class="btn btn--yes" type="button">Yes ðŸ’—</button>
          <button id="no" class="btn btn--no" type="button">No</button>
        </div>

        <p id="msg" class="msg" aria-live="polite"></p>

        <div id="after" class="after" hidden>
          <p class="after__title">Correct answer ðŸ˜ŒðŸ’—</p>
          <p class="after__text">
            Now we go eat something good, take cute pics, and Iâ€™ll pretend Iâ€™m not obsessed (I am).
          </p>
          <button class="btn btn--yes" type="button" id="again">
            Replay the moment ðŸŽ¶
          </button>
        </div>

        <footer class="footer">
          <p>Made with love ðŸ’—</p>
        </footer>
      </section>
    </main>

    <!-- confetti hearts container -->
    <div class="confetti" id="confetti" aria-hidden="true"></div>

    <script>
      const yes = document.getElementById("yes");
      const no = document.getElementById("no");
      const msg = document.getElementById("msg");
      const after = document.getElementById("after");
      const song = document.getElementById("song");
      const mainImg = document.getElementById("mainImg");
      const confetti = document.getElementById("confetti");
      const again = document.getElementById("again");
      const card = document.getElementById("card");

      const noLines = [
        "Nice try ðŸ˜­",
        "Be serious.",
        "That button is for decoration.",
        "Laniâ€¦ câ€™mon now.",
        "Not allowed.",
        "Wrong answer. Try again."
      ];

      function popConfetti() {
        confetti.innerHTML = "";
        const emojis = ["ðŸ’—","ðŸ’–","ðŸŒ¹","ðŸ’˜","ðŸ’•","ðŸŒ¸"];
        for (let i = 0; i < 36; i++) {
          const s = document.createElement("span");
          s.className = "confetti__bit";
          s.textContent = emojis[Math.floor(Math.random() * emojis.length)];
          s.style.left = Math.random() * 100 + "vw";
          s.style.animationDelay = (Math.random() * 0.2) + "s";
          s.style.fontSize = (14 + Math.random() * 22) + "px";
          confetti.appendChild(s);
        }
      }

      async function playSong() {
        // browsers allow play after user click; if file missing, it will fail silently
        try {
          song.currentTime = 0;
          await song.play();
        } catch (e) {
          // If it fails (e.g., missing mp3), show a small hint
          msg.textContent = "Music didnâ€™t load ðŸ˜­ (check the mp3 file path)";
        }
      }

      yes.addEventListener("click", async () => {
        msg.textContent = "W. Correct answer. I knew you were smart ðŸ’—";
        after.hidden = false;

        // swap image to funny pic
        mainImg.classList.add("img-pop");
        mainImg.src = "assets/images/dog.gif";
        setTimeout(() => mainImg.classList.remove("img-pop"), 240);

        // celebration + cute animation
        card.classList.add("card-win");
        popConfetti();

        // play careless whisper on YES click
        await playSong();

        // lock buttons
        yes.disabled = true;
        no.disabled = true;
      });

      again.addEventListener("click", async () => {
        await playSong();
      });

      // Make NO button dodge the cursor
      no.addEventListener("mouseenter", () => {
        const rect = card.getBoundingClientRect();
        const maxX = rect.width - no.offsetWidth - 24;
        const maxY = rect.height - no.offsetHeight - 24;

        const x = Math.max(12, Math.floor(Math.random() * maxX));
        const y = Math.max(12, Math.floor(Math.random() * maxY));

        no.style.position = "absolute";
        no.style.left = x + "px";
        no.style.top = y + "px";

        msg.textContent = noLines[Math.floor(Math.random() * noLines.length)];
      });
    </script>
  </body>
</html>
