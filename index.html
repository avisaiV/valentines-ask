<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Be My Valentine? ğŸ’—</title>
    <link rel="stylesheet" href="style.css" />
  </head>

  <body>
    <div class="bg-sparkles" aria-hidden="true"></div>

    <main class="wrap">
      <section class="card" id="card">
        <h1 class="question" id="question">
          Will you be my Valentine?
        </h1>

        <p class="sub" id="subtitle">
          Choose wisely.
        </p>

        <div class="photo" id="photo">
          <img id="mainImg" src="assets/images/monkeys.jpg" alt="Cute photo" />
        </div>

        <!-- hidden audio (no player UI) -->
        <audio id="song" preload="auto">
          <source src="assets/music/careless-whisper.mp3" type="audio/mpeg" />
        </audio>

        <div class="buttons" id="buttons">
          <button id="yes" class="btn btn--yes" type="button">Yes ğŸ’—</button>
          <button id="no" class="btn btn--no" type="button">No</button>
        </div>

        <p id="msg" class="msg" aria-live="polite"></p>

        <div id="after" class="after" hidden>
          <p class="after__title">Correct answer ğŸ˜ŒğŸ’—</p>
        </div>

        <footer class="footer">
          <p>Made with love ğŸ’—</p>
        </footer>
      </section>
    </main>

    <div class="confetti" id="confetti" aria-hidden="true"></div>

    <script>
      const yes = document.getElementById("yes");
      const no = document.getElementById("no");
      const msg = document.getElementById("msg");
      const after = document.getElementById("after");
      const song = document.getElementById("song");
      const mainImg = document.getElementById("mainImg");
      const confetti = document.getElementById("confetti");
      const card = document.getElementById("card");

      const noLines = [
        "Nice try ğŸ˜­",
        "Be serious.",
        "That button is for decoration.",
        "Laniâ€¦ câ€™mon now.",
        "Not allowed.",
        "Wrong answer. Try again."
      ];

      let noAttempts = 0;

      function popConfetti() {
        confetti.innerHTML = "";
        const emojis = ["ğŸ’—","ğŸ’–","ğŸŒ¹","ğŸ’˜","ğŸ’•","ğŸŒ¸","ğŸ’","â¤ï¸â€ğŸ”¥"];
        const count = 48;

        for (let i = 0; i < count; i++) {
          const s = document.createElement("span");
          s.className = "confetti__bit";
          s.textContent = emojis[Math.floor(Math.random() * emojis.length)];
          s.style.left = Math.random() * 100 + "vw";
          s.style.animationDelay = (Math.random() * 0.25) + "s";
          s.style.fontSize = (14 + Math.random() * 22) + "px";
          s.style.opacity = (0.75 + Math.random() * 0.25).toFixed(2);
          confetti.appendChild(s);
        }
      }

      async function playSong() {
        // Works because this is triggered by user interaction (click)
        try {
          song.currentTime = 0;
          await song.play();
        } catch (e) {
          // keep simple - no extra text changes
        }
      }

      function growYes() {
        noAttempts += 1;

        // grows each attempt but capped so it doesn't break layout
        const scale = Math.min(1 + noAttempts * 0.12, 1.9);
        yes.style.transform = `scale(${scale})`;

        // tiny bounce feel
        yes.classList.remove("yes-pop");
        void yes.offsetWidth; // reflow to restart animation
        yes.classList.add("yes-pop");
      }

      function dodgeNo() {
        const rect = card.getBoundingClientRect();
        const maxX = rect.width - no.offsetWidth - 24;
        const maxY = rect.height - no.offsetHeight - 24;

        const x = Math.max(12, Math.floor(Math.random() * maxX));
        const y = Math.max(12, Math.floor(Math.random() * maxY));

        no.style.position = "absolute";
        no.style.left = x + "px";
        no.style.top = y + "px";
      }

      yes.addEventListener("click", async () => {
        msg.textContent = "W. Correct answer. I knew you were smart ğŸ’—";
        after.hidden = false;

        // image swap (your current paths)
        mainImg.classList.add("img-pop");
        mainImg.src = "assets/images/dog.gif";
        setTimeout(() => mainImg.classList.remove("img-pop"), 240);

        card.classList.add("card-win");
        popConfetti();

        await playSong();

        yes.disabled = true;
        no.disabled = true;
      });

      // If she tries no â†’ yes grows + no dodges + message changes
      const handleNoAttempt = () => {
        if (yes.disabled) return;
        growYes();
        dodgeNo();
        msg.textContent = noLines[Math.floor(Math.random() * noLines.length)];
      };

      no.addEventListener("mouseenter", handleNoAttempt);
      no.addEventListener("click", (e) => {
        e.preventDefault();
        handleNoAttempt();
      });
    </script>
  </body>
</html>
